<app-map></app-map>
<div class="actions">

  <ng-container *ngIf="isActionInProgress$ | async; else actionsTemplate">
    <button class="actions__button actions__button--long" (click)="getMyGPSLocation()">
      <fa-icon [icon]="faSpinner" [spin]="true"></fa-icon>
    </button>
  </ng-container>
  <ng-template #actionsTemplate>
    <ng-container *ngIf="mapService.location$ | async; else requestLocationTemplate">
      <button class="actions__button" (click)="uploadData()">
        <fa-icon [icon]="faMapMarker"></fa-icon>
      </button>
      <button class="actions__button actions__button--long" (click)="checkProximity()">
        <fa-icon [icon]="faSyncAlt"></fa-icon>
        <ng-container *ngIf="dataService.lastUpdate$ | async as lastUpdate">
          <div class="last-update-date">{{ lastUpdate | amLocale:'es' | amTimeAgo }}</div>
        </ng-container>
      </button>
      <button class="actions__button" (click)="panToMyLocation()">
        <fa-icon [icon]="faMapPin"></fa-icon>
      </button>
    </ng-container>
    <ng-template #requestLocationTemplate>
      <button class="actions__button actions__button--long" (click)="getMyGPSLocation()">
        <fa-icon [icon]="faCompass"></fa-icon>
        <div class="actions__button__text">Obtener mi ubicaci√≥n</div>
      </button>
    </ng-template>
  </ng-template>
</div>
<div class="notification" *ngIf="notificationService.notification$ | async as notification">
  <ngb-toast
    [header]="notification.header"
    [autohide]="true"
    [delay]="2500"
    (hide)="notificationService.clearNotification()"
  >
    {{ notification.message }}
  </ngb-toast>
</div>
